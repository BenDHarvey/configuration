---
- name: Creates nvim config dir
  file:
    path: "{{ lookup('env','HOME') }}/.config/nvim"
    state: directory

- name: Remove file vimrc file
  file:
    path: "{{ lookup('env','HOME') }}/.vimrc"
    state: absent

- name: Link vimrc
  file:
    src: "{{ lookup('env','HOME') }}/.configuration/dotfiles/vimrc"
    dest: "{{ lookup('env','HOME') }}/.vimrc"
    state: link

- name: Remove coc-vim settings
  file:
    path: "{{ lookup('env','HOME') }}/.config/nvim/coc-settings.json"
    state: absent

- name: Link coc-settings
  file:
    src: "{{ lookup('env','HOME') }}/.configuration/dotfiles/coc-settings.json"
    dest: "{{ lookup('env','HOME') }}/.config/nvim/coc-settings.json"
    state: link

- name: Remove nvim init config
  file:
    path: "{{ lookup('env','HOME') }}/.config/nvim/init.vim"
    state: absent

- name: Link nvim init
  file:
    src: "{{ lookup('env','HOME') }}/.configuration/dotfiles/init.vim"
    dest: "{{ lookup('env','HOME') }}/.config/nvim/init.vim"
    state: link

- name: Install vim plug
  shell: curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  register: shell_result

- debug:
    var: shell_result.stdout_lines

- name: Install vim plug
  shell: nvim --headless +PlugInstall +qall
